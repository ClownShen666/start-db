FROM eclipse/ubuntu_jdk8:latest

ENV BASE_HOME /opt

WORKDIR $BASE_HOME

# SPARK
ENV SPARK_VERSION 3.0.2
ENV SPARK_PACKAGE spark-${SPARK_VERSION}-bin-hadoop3.2
ENV SPARK_HOME $BASE_HOME/$SPARK_PACKAGE
ENV PATH $PATH:${SPARK_HOME}/bin


ENV LIVY_BUILD_VERSION 0.8.0-incubating-SNAPSHOT_2.12
ENV LIVY_PACKAGE apache-livy-$LIVY_BUILD_VERSION-bin
ENV LIVY_HOME $BASE_HOME/$LIVY_PACKAGE
ENV LIVY_LOG $LIVY_HOME/logs

# add spark
ADD ./$SPARK_PACKAGE.tgz $BASE_HOME

# Unzip livy source files
ADD ./${LIVY_PACKAGE}.tgz $BASE_HOME


COPY ./livy.conf $LIVY_HOME/conf/
COPY ./log4j.properties $LIVY_HOME/conf/
RUN mkdir -p $LIVY_LOG

ENTRYPOINT $LIVY_HOME/bin/livy-server


